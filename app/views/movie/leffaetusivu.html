{% extends "base.html" %}
{% block content %}

{% import "macros/modals.html" as modals %}
{{modals.arvio_modal("#{arvioitu}","#{elokuva.leffaid}", "#{base_path}/arviopostisivu")}}

{% if message %}
<div class="alert alert-success"  style="text-shadow: none">
    {{message}}
</div>
{% endif %}
<div class="bg">
    <div class="row ">
        <div class="col-md-6"><h2>{{elokuva.leffanimi}}</h2></div>
        <div class="col-md-6">
            {% if user_logged_in %}
            <div class="btn-group">
                <div class="btn-group">
                    <button class="btn btn-warning dropdown-toggle" type="button" id="listaMenu" data-toggle="dropdown">
                        Lisää listalle
                        <span class="caret">
                        </span>
                    </button>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="listaMenu" id="listamenubuttons">
                        <form method="post" action="{{base_path}}/suosikkilisays/{{elokuva.leffaid}}">
                            <li role="presentation"><a class="lisaysbutton" role="menuitem" tabindex="-1" onclick="$(this).closest('form').submit()">Lisää suosikkeihin</a></li>
                        </form> 
                        <form method="post" action="{{base_path}}/katsottulisays/{{elokuva.leffaid}}">
                            <li role="presentation"><a class="lisaysbutton" role="menuitem" tabindex="-1" onclick="$(this).closest('form').submit()">Lisää katsottuihin</a></li>
                        </form> 
                        <form method="post" action="{{base_path}}/mastardelisays/{{elokuva.leffaid}}">
                            <li role="presentation"><a class="lisaysbutton" role="menuitem" tabindex="-1" onclick="$(this).closest('form').submit()">Lisää MásTarde</a></li>
                        </form> 
                    </ul>
                </div>
                <a role="button" class="btn btn-info" data-toggle="modal" data-target="#arviolisaysmodaali" >Arvioi</a>
                <a role="button" class="btn btn-info" href="#" >Kommentoi</a>
                <a role="button" class="btn btn-success" href="{{base_path}}/movie/edit/{{elokuva.leffaid}}">Muokkaa</a>
                {% if user_logged_in.kayttajaid == 2 %}
                <div class="btn-group">
                    <form method="post" action="{{base_path}}/movie/destroy/{{elokuva.leffaid}}">
                        <button class="btn btn-danger" type="submit" >Poista</button>
                    </form>
                </div>
                {% endif %}
            </div>
            {% else %}
            <a role="button" class="btn btn-default" href="{{base_path}}/register">Haluatko kommentoida elokuvaa? Rekisteröidy :)</a>
            {% endif %}
        </div>

    </div>
    <br>
    <div class="row">
        <div class="col-md-6">
            <ul id="tietolaatikko">

                {% if valtio %}
                <li><strong>Maa:</strong> <a href="{{base_path}}/country/{{valtio.valtioid}}">{{valtio.valtionimi}}</a></li>
                {% endif %}

                <li><strong>Julkaisuvuosi:</strong> {{elokuva.vuosi}}</li>
                <li><strong>Kieli:</strong> {{elokuva.kieli}}</li>

                {% if genret %}
                <li><strong>Genre:</strong> 
                    <ul>
                        {% for genre in genret %}
                        <li>{{genre.genrenimi}}</li>
                        {%endfor%}
                    </ul>
                </li>
                {% endif %}

                {% if ohjaajat %}
                <li><strong>Ohjaajat:</strong> 
                    <ul>
                        {% for ohjaaja in ohjaajat %}
                        <li><a href="{{base_path}}/artist/{{ohjaaja.artistiid}}"> {{ohjaaja.etunimi}} {{ohjaaja.sukunimi}}</a></li>
                        {%endfor%}
                    </ul>
                </li>
                {% endif %}

                {% if  kasikirjoittajat %}
                <li><strong>Käsikirjoittajat:</strong> 
                    <ul>
                        {% for kasikirjoittaja in kasikirjoittajat %}
                        <li><a href="{{base_path}}/artist/{{kasikirjoittaja.artistiid}}"> {{kasikirjoittaja.etunimi}} {{kasikirjoittaja.sukunimi}}</a></li>
                        {%endfor%}
                    </ul>
                </li>
                {% endif %}

                {% if  kuvaajat %}
                <li><strong>Kuvaajat:</strong> 
                    <ul>
                        {% for kuvaaja in kuvaajat %}
                        <li><a href="{{base_path}}/artist/{{kuvaaja.artistiid}}"> {{kuvaaja.etunimi}} {{kuvaaja.sukunimi}}</a></li>
                        {%endfor%}
                    </ul>
                </li>
                {% endif %}

                {% if nayttelijat %}
                <li><strong>Näyttelijät:</strong>
                    <ul>
                        {% for nayttelija in nayttelijat %}
                        <li><a href="{{base_path}}/artist/{{nayttelija.artistiid}}"> {{nayttelija.etunimi}} {{nayttelija.sukunimi}}</a></li>
                        {%endfor%}
                    </ul>
                </li>
                {% endif %}

                {%if palkinnot %}
                <li><strong>Palkinnot/Ehdokkuudet:</strong> 
                    <ul>
                        {% for palkinto in palkinnot %}
                        <li>{{palkinto.palkintonimi}}</li>
                        {%endfor%}
                    </ul>
                </li>
                {% endif %}
                
                {%if sarjatAndMovies %}
                <li><strong>Sarjat:</strong>
                    <ul>
                        {% for sarja in sarjatAndElokuvat %}
                        <li>{{sarja.sarjanimi}}
                            <ul>
                                {% for elokuvat in sarja %}
                                {% for movie in elokuvat %}
                                {% if movie.leffaid == elokuva.leffaid %}
                                <li> {{movie.leffanimi}}</li>
                                {% else %}
                                <li><a href="{{base_path}}/movie/{{movie.leffaid}}"> {{movie.leffanimi}}</a></li>
                                {% endif %}
                                {% endfor %}
                                {% endfor %}
                            </ul>
                        </li>
                        {%endfor%}
                    </ul>
                </li>
                {% endif %}
            </ul> 
            <br>           
        </div>
        {% if elokuva.traileriurl %}
        <div class="col-md-6">
            <h5>Traileri</h5>
            <div class="embed-responsive embed-responsive-16by9">
                <iframe class="embed-responsive-item" width="560" height="315" src="{{elokuva.traileriurl}}" frameborder="0" allowfullscreen></iframe>
            </div>
        </div>
        {% endif %}
    </div>
    <div class="row">
        <div class="col-md-12">
            {% if elokuva.synopsis %}
            <h5>Synopsis</h5>
            <p id="synopsis">
                {{elokuva.synopsis}}
            </p>
            {% endif %}
        </div>
    </div>

    <br>
    <div class="row">
        <div class="col-md-6" id="arviointilaatikko">
            <h5>Arviot ja kommentit</h5>
            <ul>
                {% for arvio in arviot %}
                <li>Käyttäjä <i>{{arvio.kayttajatunnus}}</i> antoi <b>{{arvio.tahti}}</b> tähteä</li>
                {%endfor%}
                {% for kommentti in kommentit %}
                <li>Käyttäjä <i>{{kommentti.kayttajatunnus}}</i>: <b>{{kommentti.teksti}}</b></li>
                {%endfor%}
            </ul>
        </div>
        <div class="col-md-6" id="dvdlistaus">
            {% if user_logged_in %}
            <h5>Käyttäjät, jotka omistavat DVD:nä</h5>
            <ul>
                {% for dvd in dvdt %}
                <li>{{dvd.kayttajatunnus}}</li>
                {%endfor%}
            </ul>
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}
